Version 4
SHEET 1 2788 5112
WIRE 768 -400 608 -400
WIRE 608 -336 608 -400
WIRE 672 -336 608 -336
WIRE 768 -320 768 -400
WIRE 768 -320 736 -320
WIRE 912 -320 768 -320
WIRE 1248 -320 912 -320
WIRE 1296 -320 1248 -320
WIRE -592 -304 -592 -336
WIRE -400 -304 -400 -336
WIRE 672 -304 560 -304
WIRE 704 -224 704 -288
WIRE 912 -224 912 -240
WIRE -592 -192 -592 -224
WIRE -592 -192 -784 -192
WIRE -400 -192 -400 -224
WIRE -400 -192 -592 -192
WIRE -352 -192 -400 -192
WIRE -224 -192 -224 -224
WIRE -224 -192 -352 -192
WIRE 192 -160 192 -208
WIRE 160 -144 -64 -144
WIRE 192 -144 192 -160
WIRE -352 -128 -352 -192
WIRE 336 -128 224 -128
WIRE 384 -128 336 -128
WIRE 800 -128 688 -128
WIRE 1024 -128 880 -128
WIRE 1232 -128 1072 -128
WIRE -352 -112 -352 -128
WIRE 112 -112 48 -112
WIRE 160 -112 112 -112
WIRE 48 -32 48 -112
WIRE 48 -32 32 -32
WIRE 192 -32 192 -96
WIRE 752 -32 752 -48
WIRE 1072 -32 1072 -128
WIRE 1136 -32 1072 -32
WIRE 688 -16 688 -128
WIRE 720 -16 688 -16
WIRE 1232 -16 1232 -128
WIRE 1232 -16 1200 -16
WIRE 1280 -16 1232 -16
WIRE -352 0 -352 -48
WIRE 848 0 784 0
WIRE 944 0 928 0
WIRE 1024 0 1024 -128
WIRE 1024 0 1008 0
WIRE 1136 0 1024 0
WIRE 592 16 544 16
WIRE 720 16 672 16
WIRE 1024 16 1024 0
WIRE 48 64 48 -32
WIRE 48 64 32 64
WIRE 144 64 48 64
WIRE 336 64 336 -128
WIRE 336 64 224 64
WIRE 752 80 752 32
WIRE 1168 80 1168 16
WIRE -352 112 -352 80
WIRE -352 240 -352 192
WIRE -208 240 -352 240
WIRE 432 240 432 224
WIRE 704 256 704 240
WIRE 976 320 912 320
WIRE 1024 320 976 320
WIRE 1136 320 1104 320
WIRE 912 336 912 320
WIRE 272 352 112 352
WIRE 432 352 432 320
WIRE 448 352 432 352
WIRE 560 352 528 352
WIRE 704 368 704 336
WIRE 720 368 704 368
WIRE 832 368 800 368
WIRE 112 448 112 352
WIRE 176 448 112 448
WIRE 912 448 912 416
WIRE 272 464 272 352
WIRE 272 464 240 464
WIRE 320 464 272 464
WIRE 432 464 432 352
WIRE 432 464 400 464
WIRE 464 464 432 464
WIRE 976 464 976 320
WIRE 1008 464 976 464
WIRE -16 480 -48 480
WIRE 144 480 64 480
WIRE 176 480 144 480
WIRE 560 480 560 352
WIRE 560 480 528 480
WIRE 592 480 560 480
WIRE 704 480 704 368
WIRE 704 480 672 480
WIRE 736 480 704 480
WIRE 1136 480 1136 320
WIRE 1136 480 1072 480
WIRE 1248 480 1136 480
WIRE 1296 480 1248 480
WIRE 464 496 432 496
WIRE 832 496 832 368
WIRE 832 496 800 496
WIRE 1008 496 832 496
WIRE 144 512 144 480
WIRE 736 512 704 512
WIRE 1040 528 1040 512
WIRE 432 544 432 496
WIRE 496 544 496 512
WIRE 208 560 208 496
WIRE 704 560 704 512
WIRE 768 560 768 528
WIRE 144 608 144 592
FLAG -784 -192 0
FLAG -400 -336 vcc
FLAG 192 -208 vcc
FLAG 192 -32 0
FLAG 752 80 0
FLAG 752 -48 vcc
FLAG 1024 80 0
FLAG 1280 -16 v_min
FLAG -64 -144 v_in
FLAG 384 -128 v_out
FLAG -48 -32 v_max
FLAG -48 64 v_min
FLAG 704 -352 vcc
FLAG 704 -224 0
FLAG 912 -224 0
FLAG 112 -112 v_comp
FLAG 1168 -48 vcc
FLAG 1168 80 0
FLAG 768 464 vcc
FLAG 768 560 0
FLAG 1040 448 vcc
FLAG 704 560 virtgnd
FLAG 912 448 0
FLAG 704 240 vos
FLAG 1248 480 v_max
FLAG -224 -304 virtgnd
FLAG 208 432 vcc
FLAG 208 560 0
FLAG 144 608 0
FLAG 496 448 vcc
FLAG 496 544 0
FLAG 432 544 virtgnd
FLAG 432 224 virtgnd
FLAG 1040 528 0
FLAG -592 -336 vos
FLAG 1248 -320 v_load
FLAG -208 240 v_in
FLAG 560 -304 v_out
FLAG 544 16 v_in
FLAG -48 480 v_min
DATAFLAG 1296 -320 ""
DATAFLAG 1296 480 ""
SYMBOL voltage -400 -320 R0
WINDOW 3 -107 55 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 8 6 Left 2
SYMATTR Value {VCC}
SYMATTR InstName vcc
SYMBOL res 128 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R_feedback
SYMATTR Value 470k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 48 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res -64 -16 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL voltage -352 208 R180
WINDOW 0 -113 70 Bottom 2
WINDOW 3 47 58 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 93 56 VBottom 2
SYMATTR InstName PsuedoNoise
SYMATTR Value SFFM(0 {1*VCC*0.015} 173 3 53)
SYMBOL Comparators\\LT1017 192 -128 R0
SYMATTR InstName U1
SYMBOL schottky 1008 -16 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 1008 16 R0
WINDOW 3 45 47 Left 2
SYMATTR Value 100n
SYMATTR InstName C2
SYMBOL res 896 -144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 688 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 896 -336 R0
SYMATTR InstName R5
SYMATTR Value 1meg
SYMBOL voltage -352 96 R180
WINDOW 0 -111 67 Bottom 2
WINDOW 3 49 57 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName AnalogInput
SYMATTR Value PULSE({VL} {VH} .5 .01 .05 .02 {PERIOD})
SYMBOL voltage -352 -32 R180
WINDOW 0 -116 58 Left 2
WINDOW 3 45 57 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Sweep
SYMATTR Value SINE({VCC*0.3} {VCC*0.3} .09)
SYMBOL res 688 464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 720 352 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 816 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL voltage -224 -320 R0
WINDOW 3 -97 54 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value {VG}
SYMATTR InstName vg
SYMBOL res 80 464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 160 608 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 416 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 448 336 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R19
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 544 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 928 432 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL res 1120 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 100k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL voltage -592 -320 R0
WINDOW 3 -42 53 Right 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 77 12 Right 2
SYMATTR Value {VG*(1 - OFFSET)}
SYMATTR InstName vos
SYMBOL res 944 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 47k
SYMATTR SpiceLine tol=2 pwr=0.25
SYMBOL Opamps\\LT6005 752 0 R0
SYMATTR InstName U2
SYMBOL Opamps\\LT6005 704 -320 R0
SYMATTR InstName U3
SYMBOL Opamps\\LT6005 1168 -16 R0
SYMATTR InstName U4
SYMBOL Opamps\\LT6005 208 464 R0
SYMATTR InstName U6
SYMBOL Opamps\\LT6005 496 480 R0
SYMATTR InstName U7
SYMBOL Opamps\\LT6005 768 496 R0
SYMATTR InstName U8
SYMBOL Opamps\\LT6005 1040 480 R0
SYMATTR InstName U9
TEXT -864 464 Left 2 !.tran 15  startup\n.param VCC=1.8 PERIOD=1\n* values in percentage\n.param TL=0.1 TH=0.3\n.param VL=VCC*TL VH=VCC*TH \n.param VG=VCC/2 OFFSET=TH-TL \n.step param VCC LIST 1.8 3.3\n.step param PERIOD LIST 2 0.1
TEXT -856 -128 Left 2 ;Test signal
TEXT -120 -256 Left 2 ;Pulse detection
TEXT 1352 -152 Right 2 ;Minimum peak follower
TEXT 1352 -392 Right 2 ;Output buffer
TEXT 1360 144 Right 2 ;Summing amp
TEXT -864 320 Left 5 ;LT6005 = MCP6044\nLT1017 = MCP6541
TEXT 832 624 Left 2 ;- ( - (v_min/2 + virtgnd) + vos) * 2 = v_max
TEXT -856 -384 Left 2 ;Power supply
RECTANGLE Normal -144 272 -864 -144
RECTANGLE Normal 464 -272 -128 112
RECTANGLE Normal 1360 112 480 -176
RECTANGLE Normal 1360 -192 480 -416
RECTANGLE Normal 1368 656 -128 128
RECTANGLE Normal -144 -160 -864 -408
